# MiKo_3041: Do not use delegates in EventArgs

## Cause

An `EventArgs` class contains a delegate property or field.

## Rule description

Avoid using delegates like `Action` or `Func` in `EventArgs`.
The callee must understand exactly how the delegate behaves.
Failures within the delegate are difficult to debug, as exceptions are thrown in unrelated areas.

### Rationale behind

Event arguments should represent data about an event, not executable code.
When delegates are included in event arguments, it blurs the line between notification and callback, creating complex interactions that are hard to understand and debug.

Avoiding delegates in EventArgs provides several important benefits:

- **Clear Separation of Concerns**:
  Events notify subscribers about something that happened, while delegates represent executable behavior.
  Mixing these concepts creates confusion about the purpose and flow of code.

- **Easier Debugging**:
  When exceptions occur in delegates passed through EventArgs, stack traces can be confusing.
  It becomes unclear whether the problem is in the event raiser, the subscriber, or the delegate itself.

- **Better Testability**:
  Events with simple data are easier to test than events that require configuring delegate behavior.
  Tests can verify the event data without needing to set up complex callback scenarios.

- **Reduced Coupling**:
  Delegates in EventArgs create tight coupling between event raisers and subscribers.
  The raiser must know when and how to invoke the delegate, increasing dependencies.

- **Simpler Event Handling**:
  Subscribers can focus on responding to event data rather than managing delegate invocations.
  This makes event handling more straightforward and predictable.

- **Thread Safety**:
  Delegates executed from EventArgs can introduce threading issues if invoked on different threads.
  Simple data in EventArgs avoids these complications.

## How to fix violations

To fix a violation of this rule, redesign the event to pass only data through EventArgs.
If callbacks are needed, use separate events or methods instead of delegates in event arguments.
Consider using interfaces to define expected behavior rather than delegates.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3041
#pragma warning restore MiKo_3041
```
