# MiKo_3214: Remove `Begin/End` or `Enter/Exit` scope-defining methods from interfaces

## Cause

An interface contains methods that start with `Begin`, `Enter`, `End`, or `Exit` that define a scope.

## Rule description

Methods starting with `Begin` or `Enter` often have counterparts like `End` or `Exit`, defining a scope (e.g., `BeginUpdate` and `EndUpdate`).
Public access to these methods can lead to errors if `End` methods are not correctly invoked.

Instead, provide a method that returns an `IDisposable`.
This way, developers can use a `using` statement to ensure the `End` method is always called, keeping everything clean and error-free.

### Rationale behind

Scope-defining method pairs require developers to remember to call the closing method.
Forgetting to call the `End` or `Exit` method can cause resource leaks, deadlocks, or incorrect program state.

Replacing scope methods with `IDisposable` provides several important benefits:

- **Improved Safety**:
  The `using` statement guarantees the cleanup method is called.
  Resources are always released even if exceptions occur.

- **Better Reliability**:
  Developers cannot forget to call the closing method.
  The compiler and runtime enforce proper cleanup.

- **Reduced Errors**:
  Exception handling between `Begin` and `End` calls can be complex.
  The `using` pattern handles this automatically.

- **Enhanced Maintainability**:
  Code using `using` statements is clearer and more concise.
  The scope is visually apparent through indentation.

- **Clearer Intent**:
  The `using` statement clearly shows the beginning and end of the scope.
  The code's structure communicates the resource lifetime.

- **Consistent Pattern**:
  Using `IDisposable` for scopes is a standard .NET pattern.
  This makes the API familiar to developers.

## How to fix violations

To fix a violation of this rule, replace the `Begin/End` or `Enter/Exit` method pairs with a single method that returns `IDisposable`.
The returned object should call the `End` or `Exit` logic in its `Dispose` method.
Developers can then use a `using` statement to ensure proper cleanup.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3214
#pragma warning restore MiKo_3214
```
