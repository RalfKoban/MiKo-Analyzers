# MiKo_3094: Do not invoke methods or properties of parameters inside locks

## Cause

A method or property of a parameter is invoked within a lock statement.

## Rule description

To avoid deadlocks, do not invoke methods or properties of parameters within lock statements.
This practice ensures smooth and efficient code execution while avoiding potential deadlocks.

### Rationale behind

Invoking methods or properties on parameters inside lock statements allows external object code to execute while holding a lock.
This creates opportunities for deadlocks because the parameter objects might have their own synchronization logic that conflicts with the current lock.

Avoiding parameter method/property invocation in locks provides several important benefits:

- **Prevents Deadlocks**:
  Parameter objects might have their own locking mechanisms.
  If a parameter's method tries to acquire a lock while the current lock is held, and another thread holds the parameter's lock while trying to acquire the current lock, a deadlock occurs.

- **Reduces Lock Hold Time**:
  Methods and properties on parameter objects can execute complex operations that take significant time.
  Holding locks during these operations increases contention and reduces application performance.

- **Avoids Cross-Object Synchronization Issues**:
  When locks are held while calling into external objects, it creates complex synchronization dependencies between objects.
  This makes the system much harder to reason about and prone to subtle threading bugs.

- **Prevents Unexpected Blocking**:
  Parameter object methods might block on I/O, network operations, or other long-running tasks.
  Blocking while holding a lock can cause other threads to stall unnecessarily.

- **Improves Code Modularity**:
  When code does not call parameter methods inside locks, each object's synchronization is independent.
  This makes the code more modular and easier to maintain.

- **Enables Better Testing**:
  Code that separates lock boundaries from external method calls is easier to test for thread safety.
  Test cases can focus on the synchronization logic without needing to mock complex parameter behavior.

## How to fix violations

To fix a violation of this rule, invoke the parameter's methods or properties before acquiring the lock and store the results in local variables.
Use the local variables inside the lock instead of calling through the parameter.
Alternatively, release the lock before invoking parameter methods if the operation does not need to be synchronized.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3094
#pragma warning restore MiKo_3094
```
