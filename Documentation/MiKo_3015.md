# MiKo_3015: Use InvalidOperationExceptions for inappropriate states of parameterless methods

## Cause

A parameterless method throws an `ArgumentException` (or subtype).

## Rule description

Avoid throwing `ArgumentException` (or its subtypes) in parameterless methods.
If a method does not take any arguments, or if the failure is not related to the arguments themselves, use `InvalidOperationException` instead.
This keeps exception handling logical and context-appropriate, making the code cleaner and easier to maintain.

### Rationale behind

`ArgumentException` is specifically designed for parameter validation failures.
When a method has no parameters or when the failure is due to object state rather than parameter values, using `ArgumentException` is semantically incorrect.

Using `InvalidOperationException` for state-related failures provides several important benefits:

- **Correct Semantic Meaning**:
  `InvalidOperationException` indicates that the operation cannot be performed in the current state.
  This accurately describes the problem when parameters are not the issue.

- **Clearer Error Classification**:
  The exception type immediately communicates whether the problem is with input or with state.
  This distinction is crucial for proper error handling.

- **Better Error Handling**:
  Code that catches `ArgumentException` expects parameter validation issues.
  Using the wrong exception type can trigger inappropriate error handling logic.

- **Improved Code Understanding**:
  When developers see `InvalidOperationException`, they know to check the object's state.
  This guides debugging efforts in the right direction.

- **Consistent API Design**:
  Following .NET conventions for exception usage makes the API more predictable.
  Developers familiar with the framework will immediately understand the error conditions.

## How to fix violations

To fix a violation of this rule, replace the `ArgumentException` with an `InvalidOperationException`.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3015
#pragma warning restore MiKo_3015
```
