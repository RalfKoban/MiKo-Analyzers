# MiKo_3107: Use Moq Mock condition matchers only on mocks

## Cause

A test method uses Moq condition matchers like `It.Is<T>()` or `It.IsAny<T>()` on constructors or methods of non-mock objects.

## Rule description

Using Moq mocks improperly can cause issues.
Use condition matchers on mocks to set up or verify conditions.
Avoid using them on constructors or methods of non-mocks, as they do not make sense there.
This ensures mocking is effective and the code stays clear and accurate.

### Rationale behind

Moq condition matchers are specifically designed for configuring and verifying mock object behavior.
When used on regular objects or constructors, they do not function as intended and can lead to confusing test failures.

This rule provides several important benefits:

- **Prevents Test Errors**:
  Condition matchers only work within Moq's framework for mock objects.
  Using them on regular objects will not produce the expected matching behavior and can cause tests to fail unexpectedly.

- **Improves Code Clarity**:
  Seeing condition matchers signals that mock behavior is being configured or verified.
  When used incorrectly, they create confusion about whether an object is mocked or real.

- **Ensures Correct Mocking**:
  Proper use of condition matchers ensures that mock setups and verifications work as intended.
  Misuse can silently fail to configure mocks properly, leading to false test results.

- **Better Test Reliability**:
  Tests that use mocking correctly are more reliable and predictable.
  Incorrect usage can cause intermittent failures that are difficult to diagnose.

- **Clearer Test Intent**:
  Correct use of Moq matchers makes it obvious which objects are mocks and which are real.
  This separation helps developers understand the test structure at a glance.

- **Easier Maintenance**:
  When mocking is used correctly, tests are easier to update when interfaces or behavior changes.
  Incorrect usage creates technical debt that complicates future maintenance.

## How to fix violations

To fix a violation of this rule, remove condition matchers from non-mock objects and use actual values instead, or ensure the object is properly mocked.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3107
#pragma warning restore MiKo_3107
```
