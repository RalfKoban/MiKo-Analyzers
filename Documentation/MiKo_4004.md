# MiKo_4004: Place Dispose methods before all other methods of the same accessibility

## Cause

Dispose methods are not placed before all other methods of the same accessibility.

## Rule description

Dispose methods are tied to the object's lifetime.
Therefore, place them before all other methods of the same accessibility to keep related code together.
This organization ensures clarity and makes the code easier to find, understand and maintain.

### Rationale behind

Dispose methods handle critical resource cleanup and are fundamentally different from regular methods because they deal with object lifetime rather than object behavior.

By placing Dispose methods before other methods of the same accessibility, the importance of resource cleanup is emphasized and the code structure reflects the distinction between lifetime management and regular functionality.

Placing Dispose methods before all other methods of the same accessibility provides several important benefits:

- **Emphasized Importance**:
  Positioning Dispose methods early highlights their critical role in resource management.
  This ensures developers are aware of cleanup requirements when working with the type.

- **Consistent Lifecycle Organization**:
  This placement keeps all lifecycle-related methods (constructors, finalizers, Dispose) grouped near the top of the class.
  Developers can quickly locate all code related to object lifetime in one area.

- **Better Separation of Concerns**:
  Disposing is conceptually different from regular operations.
  Placing Dispose methods separately from behavioral methods makes this distinction clear and improves code organization.

- **Easier Code Review**:
  When Dispose methods are in a predictable location, reviewers can quickly find and verify disposal logic.
  This is particularly important for ensuring proper resource management.

- **Improved Discoverability**:
  Developers looking to understand how a type cleans up resources know exactly where to look.
  They do not need to search through all methods to find disposal logic.

- **Reduced Risk of Oversight**:
  When Dispose methods are prominently placed, developers are less likely to overlook them when maintaining the class.
  This helps prevent resource leaks from incomplete cleanup.

## How to fix violations

To fix a violation of this rule, move the Dispose methods so they appear before all other methods that have the same accessibility level.

For example, public Dispose methods should come before other public methods, and protected Dispose methods should come before other protected methods.

## How to suppress violations

```csharp
#pragma warning disable MiKo_4004
#pragma warning restore MiKo_4004
```
