# MiKo_3118: Do not use ambiguous Linq calls in test methods

## Cause

A test method uses ambiguous LINQ methods such as `Skip`, `Take`, `First`, `FirstOrDefault`, `Last`, `LastOrDefault`, `Single`, or `SingleOrDefault`.

## Rule description

Make tests as explicit as possible.
LINQ calls like `Skip`, `Take`, or `FirstOrDefault` are useful in production but can be unclear in tests.
Using `Skip` in a test, for example, can confuse readers about why values are being skipped.
This ambiguity requires extra effort to understand.
Avoid this by being more explicit about the expected outcome.

### Rationale behind

Tests should be as clear and explicit as possible to ensure they are easy to understand and maintain.
LINQ methods that select items by position or use implicit selection logic obscure the test's intent and make failures harder to diagnose.

This rule provides several important benefits:

- **Improved Test Clarity**:
  Explicitly specifying expected values makes tests self-documenting.
  Developers can immediately see what data the test expects without tracing through LINQ operations.

- **Better Failure Messages**:
  When tests use explicit values, failure messages show exactly what was expected versus what was received.
  LINQ operations can make it unclear which item in a collection caused the failure.

- **Easier Debugging**:
  Explicit tests do not require developers to mentally execute LINQ queries to understand what is being tested.
  The test intent is immediately obvious from reading the code.

- **Reduced Ambiguity**:
  Methods like `Skip` or `Take` raise questions about why certain items are excluded or included.
  Explicit item selection eliminates this confusion.

- **More Robust Tests**:
  Tests with explicit expectations are less likely to pass accidentally when collection order changes.
  LINQ position-based selections can silently select wrong items if data changes.

- **Better Test Maintenance**:
  When requirements change, explicit tests are easier to update.
  Developers can clearly see what needs to change without analyzing LINQ query logic.

## How to fix violations

To fix a violation of this rule, replace ambiguous LINQ calls with explicit value specifications or collection assertions that verify exact expected contents.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3118
#pragma warning restore MiKo_3118
```
