# MiKo_3074: Do not define `ref` or `out` parameters on constructors

## Cause

A constructor defines a `ref` or `out` parameter.

## Rule description

A constructor's main purpose is to create an initialized instance of its specific type.
It should not be used to create instances of other types.
Therefore, including `ref` or `out` parameters in a constructor contradicts this concept.
These parameters should not exist to provide instances of other types, in addition to the instance created and initialized by the constructor.

### Rationale behind

Constructors have a single, well-defined purpose: to create and initialize an object of a specific type.
Adding `ref` or `out` parameters to constructors violates this fundamental principle and creates confusing APIs that are difficult to use correctly.

Avoiding `ref` and `out` parameters in constructors provides several important benefits:

- **Maintains Single Responsibility**:
  Constructors should only be responsible for initializing the object being created.
  Using `ref` or `out` parameters adds additional responsibilities that belong elsewhere.

- **Improves API Clarity**:
  When constructors only return the object being constructed, the API is straightforward and easy to understand.
  Adding `ref` or `out` parameters makes the constructor's purpose unclear and confusing.

- **Prevents Design Issues**:
  Needing to return multiple values from a constructor often indicates a design problem.
  This typically suggests that the class has too many responsibilities or that initialization logic should be separated into factory methods.

- **Simplifies Object Creation**:
  Developers expect constructors to simply create an object.
  Having to pass variables to receive additional output values complicates the creation process unnecessarily.

- **Enables Better Alternatives**:
  Factory methods, builder patterns, or separate initialization methods are clearer ways to handle complex creation scenarios that might need to return multiple values.

- **Supports Framework Patterns**:
  Many .NET features like dependency injection, serialization, and reflection expect constructors to follow standard conventions.
  Using `ref` or `out` parameters can break compatibility with these features.

## How to fix violations

To fix a violation of this rule, remove the `ref` or `out` parameters from the constructor.
If multiple related objects need to be created together, use a factory method that returns a tuple or a dedicated result class.
If the constructor needs to communicate initialization status, throw an exception for failure cases instead of using `out` parameters.

## How to suppress violations

```csharp
#pragma warning disable MiKo_3074
#pragma warning restore MiKo_3074
```
